<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="leiheng">
  
  
  
  <link rel="prev" href="https://leiheng.github.io/posts/design-patterns/create-an-object/" />
  <link rel="next" href="https://leiheng.github.io/posts/linux/linux-sharing/" />
  <link rel="canonical" href="https://leiheng.github.io/posts/linux/linux-command/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
  <title>
       
       
           Linux Command | Ray&#39;s Blog
       
  </title>
  <meta name="title" content="Linux Command | Ray&#39;s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/leiheng.github.io"
    },
    "articleSection" : "posts",
    "name" : "Linux Command",
    "headline" : "Linux Command",
    "description" : "bash script include other bash file in your script Above answers is correct, but if run script in other folder, there will be some problem. For example, the a.sh and b.sh are in same folder, a include b with . .\/b.sh to include. When run script out of the folder, for example with xx\/xx\/xx\/a.sh, file b.sh will not found: .\/b.sh: No such file or directory. I use . $(dirname \x26quot;$0\x26quot;)\/b.sh",
    "inLanguage" : "zh-cn",
    "author" : "leiheng",
    "creator" : "leiheng",
    "publisher": "leiheng",
    "accountablePerson" : "leiheng",
    "copyrightHolder" : "leiheng",
    "copyrightYear" : "2019",
    "datePublished": "2019-08-05 15:53:33 \x2b0800 CST",
    "dateModified" : "2019-08-05 15:53:33 \x2b0800 CST",
    "url" : "https:\/\/leiheng.github.io\/posts\/linux\/linux-command\/",
    "wordCount" : "1323",
    "keywords" : [ "linux", "Ray\x27s Blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
            
            <span class="logo_mark" >></span>
            <a href="https://leiheng.github.io">
                <span class="logo_text" >$ cd /home/ </span>
                <span class="logo_cursor" ></span>
            </a>
            
        </div>
        <div class="navbar-right">
                
                <span class="menu">
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                </span>
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     
         <div class="top-scroll-bar"></div>
     
     <div class="container">
        <div class="navbar-header">
            <div class="header-logo">
                
                    <span class="logo_mark">></span>
                    <a href="https://leiheng.github.io">
                        <span class="logo_text">$ cd /home/ </span>
                        <span class="logo_cursor"></span>
                </a>
                
            </div>
            <div class="navbar-right">
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
                <div class="menu-toggle">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Linux Command</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://leiheng.github.io" rel="author">leiheng</a> with ♥ 
                <span class="post-time">
                on <time datetime=2019-08-05 itemprop="datePublished">August 5, 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://leiheng.github.io/categories/linux/"> linux </a>
                        
                </span>
                <span class="post-word-count">, 1323 words</span>
        </div>
    </header>
    <div class="post-content">
        

        
        
        
     
          
          
          

          
          
          

          

<h2 id="bash-script">bash script</h2>

<hr />

<h3 id="include-other-bash-file-in-your-script-https-stackoverflow-com-questions-10823635-how-to-include-file-in-a-bash-shell-script">include other bash file in your <a href="https://stackoverflow.com/questions/10823635/how-to-include-file-in-a-bash-shell-script" rel="nofollow noreferrer" target="_blank">script</a></h3>

<blockquote>
<p>Above answers is correct, but if run script in other folder, there will be some problem.
For example, the a.sh and b.sh are in same folder, a include b with  . ./b.sh to include.
When run script out of the folder, for example with xx/xx/xx/a.sh, file b.sh will not found: ./b.sh: No such file or directory.
I use</p>
</blockquote>

<p><code>. $(dirname &quot;$0&quot;)/b.sh</code></p>

<h3 id="common">common</h3>

<ul>
<li><p>Linux提供<code>$?</code>特殊变量来保存最后一条命令执行结束的退出状态, 正常的情况下，命令成功执行完成的退出状态是0</p>

<pre><code class="language-sh">if [$? -eq 0] ; then
</code></pre>

<blockquote>
<ul>
<li><code>set -e</code></li>
</ul>
</blockquote></li>
</ul>

<p>在<code>set -e</code>之后出现的代码，一旦出现了除0之外的返回值，整个脚本直接退出</p>

<blockquote>
<ul>
<li><code>bash -c</code></li>

<li><p><code>bash -x</code></p>

<pre><code class="language-bash">bash -x -c &quot;curl www.google.com &amp;&amp; ls&quot;
</code></pre>

<p><code>-x</code>:表示debug,会将执行的命令一个一个打出来; <code>-c</code>：则是执行收到的字符串 (如例子就是执行<code>curl www.google.com &amp;&amp; ls</code>)</p></li>

<li><p>source</p></li>

<li><p>. ./filename</p></li>

<li><p>./filename <strong><a href="https://superuser.com/questions/176783/what-is-the-difference-between-executing-a-bash-script-vs-sourcing-it?noredirect=1&amp;lq=1" rel="nofollow noreferrer" target="_blank">reference</a></strong></p></li>
</ul>
</blockquote>

<h2 id="common-1">Common</h2>

<hr />

<ul>
<li><code>groups</code></li>
<li><code>/etc/passwd</code></li>
<li><a href="https://www.computerhope.com/unix/umkdir.htm" rel="nofollow noreferrer" target="_blank">mkdir</a> -p /&hellip;. 创建目录并创建他的父目录 java中有mkdirs</li>
<li><code>find</code><a href="http://www.oracle.com/technetwork/cn/topics/calish-find-096463-zhs.html" rel="nofollow noreferrer" target="_blank">refer</a></li>

<li><p>create huge file: <code>fallocate -l 10G fileName.txt</code></p>

<h3 id="查看版本信息">查看版本信息</h3></li>

<li><p><code>cat /etc/*release</code></p></li>
</ul>

<h3 id="查看命令完整路径">查看命令完整路径</h3>

<p><code>readlink -f jmeter</code> -&gt; <code>/root/apach-jmeter/bin/jmeter</code></p>

<h3 id="diff-between-sudo-and-su">diff between sudo and su</h3>

<h3 id="环境变量">环境变量</h3>

<ol>
<li>printenv 打印环境变量</li>
<li>export PATH=$PATH:dir 导入环境变量</li>

<li><p>source /etc/profile //在不重启终端的情况下使修改过后的profile生效
&gt; docker 中不提倡用source</p>

<h4 id="shell-envsubst-replace-placeholder">shell <code>envsubst</code> replace placeholder</h4></li>
</ol>

<p>substitute env variables:</p>

<pre><code class="language-sh">source ${env_script}
cat /opt/content/cfg.tmpl | envsubst &gt; /opt/content/config/Content.cfg
</code></pre>

<p>这个意思就是把tmpl文件中的placeholder 替换,然后将输出写成cfg文件</p>

<h2 id="文件相关">文件相关</h2>

<hr />

<h3 id="文件权限相关">文件权限相关</h3>

<ol>
<li><code>chmod -R</code>: change modify 更改文件的访问权限(递归，将下层文件权限也改了)</li>
<li><code>chmod +x</code>: 加执行权限(注意的是<strong>X</strong>和x不一样)</li>
<li><code>chmod g+s</code>: 执行此 command ，在此目录下，不管是谁创建新的目录都会与父目录有相同 own</li>
<li><code>chown</code> ：change owner 更改文件拥有者 !!! chown doesn&rsquo;t check if the uid and gid haven&rsquo;t registed in /etc/group and /etc/passwd</li>
<li><code>groupadd -g gid uidname</code></li>
<li><code>useradd -g gid -u uid uername</code></li>
<li><code>su -u username -E nohup</code></li>
</ol>

<h3 id="文件目录切换">文件目录切换</h3>

<ul>
<li>pushed +n(n 是数字)</li>
<li>dirs -v</li>
<li>popd +n</li>
</ul>

<h2 id="read-file">Read file</h2>

<hr />

<h3 id="屏幕持续输出-并将输出内容保存文件">屏幕持续输出，并将输出内容保存文件</h3>

<p><code>cmd|tee filename</code>
示例：
<code>kl pod -f|tee filename</code></p>

<h3 id="cat">cat</h3>

<pre><code class="language-bash">cat &gt; filename &lt;&lt;-EOF
first
second
EOF
----------
cat &lt;&lt;- EOF &gt; filename 
first
second
EOF
</code></pre>

<p><strong>两种写法都可以</strong></p>

<blockquote>
<p>将输入的多行内容写入到filename这个文件中去.
&lt;&lt;- 的唯一变化就是Here Document 的内容部分每行前面的 tab (制表符)将会被删除掉，这种用法是为了编写Here Document的时候可以将内容部分进行缩进，方便阅读代码.eof=&gt;end of file,他可以被替换成其他合法字符</p>

<h3 id="more-less">more|less</h3>

<p>less is more
<code>more file</code>: 空格翻屏</p>

<h3 id="tail">tail</h3>

<p>tail 是从文件尾部读的，有篇<a href="https://blog.lilydjwg.me/2018/9/20/never-tail-f-a-pipe.213518.html" rel="nofollow noreferrer" target="_blank">blog</a>很有意思,里面讲了一个bug，但是也讲了tail的原理</p>

<h2 id="文件传输">文件传输</h2>

<h3 id="scp">scp</h3>

<p>I love scp
<code>scp remote-host:remote-file local-file</code></p>
</blockquote>

<h3 id="sftp">sftp</h3>

<p>比如本地ip是li-1，远程是li-4
- 连接远程服务器</p>

<p><code>sftp username@remoteIP</code>
- 本地文件传输到远端</p>

<p><code>put -r filename</code>
注意本地是指li-1
- 远端文件下载到本地</p>

<p><code>get -r filename</code></p>

<pre><code class="language-console">bye                                Quit sftp
cd path                            Change remote directory to 'path'
chgrp grp path                     Change group of file 'path' to 'grp'
chmod mode path                    Change permissions of file 'path' to 'mode'
chown own path                     Change owner of file 'path' to 'own'
df [-hi] [path]                    Display statistics for current directory or
                                   filesystem containing 'path'
exit                               Quit sftp
get [-afPpRr] remote [local]       Download file
reget [-fPpRr] remote [local]      Resume download file
reput [-fPpRr] [local] remote      Resume upload file
help                               Display this help text
lcd path                           Change local directory to 'path'
lls [ls-options [path]]            Display local directory listing
lmkdir path                        Create local directory
ln [-s] oldpath newpath            Link remote file (-s for symlink)
lpwd                               Print local working directory
ls [-1afhlnrSt] [path]             Display remote directory listing
lumask umask                       Set local umask to 'umask'
mkdir path                         Create remote directory
progress                           Toggle display of progress meter
put [-afPpRr] local [remote]       Upload file
pwd                                Display remote working directory
quit                               Quit sftp
rename oldpath newpath             Rename remote file
rm path                            Delete remote file
rmdir path                         Remove remote directory
symlink oldpath newpath            Symlink remote file
version                            Show SFTP version
!command                           Execute 'command' in local shell
!                                  Escape to local shell
?                                  Synonym for help
</code></pre>

<h2 id="端口相关">端口相关</h2>

<hr />

<ul>
<li>查看这个端口有没有开放 <code>lsof -i:80</code>,如果有显示输出就说明开放了。</li>
<li>查看某一端口的情况 <code>netstat -pan|grep 8090</code></li>
</ul>

<h2 id="security">Security</h2>

<hr />

<ul>
<li><a href="https://wangchujiang.com/linux-command/c/iptables.html" rel="nofollow noreferrer" target="_blank">防火墙iptable</a></li>
<li><a href="https://jimmysong.io/posts/envoy-sidecar-injection-in-istio-service-mesh-deep-dive/" rel="nofollow noreferrer" target="_blank">list</a></li>
</ul>

<h2 id="上古命令">上古命令</h2>

<hr />

<ul>
<li>在vim里面<code>ctrl + s</code>卡死屏幕
<code>ctrl + q</code>恢复 (以及在有道云里面也会这样)</li>
</ul>

<h2 id="process">process</h2>

<hr />

<h3 id="list-process">list process</h3>

<ul>
<li><code>ps</code> list all process</li>
<li><code>ps -aux</code> or <code>ps -ef</code></li>
<li><code>top -Hp pid</code> list all thread in one process</li>
<li><code>jstack pid &gt; pid.log</code> 将线程栈 dump 到日志文件中</li>
</ul>

<h3 id="kill-process">kill process</h3>

<ul>
<li><code>SIGINT</code> 跟<code>ctrl+c</code>关联，只能杀掉前台进程</li>
<li><code>SIGTERM</code> 处理前台、后台进程但是可以被阻塞、被忽略。可以让程序友好的退出</li>
<li><code>SIGKILL</code> 立即执行，大杀器，是直接发往系统内核的。</li>
<li><code>kill -9</code> 卧槽，很危险，危险到这是没有办法了才执行的。</li>
</ul>

<h2 id="subshell">subshell</h2>

<hr />

<p><br></p>

<p><center>  ·End·  </center></p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>leiheng </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://leiheng.github.io/posts/linux/linux-command/>https://leiheng.github.io/posts/linux/linux-command/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://leiheng.github.io/tags/linux/">
                    #linux</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://leiheng.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://leiheng.github.io/posts/design-patterns/create-an-object/" class="prev" rel="prev" title="Create an Object"><i class="iconfont icon-left"></i>&nbsp;Create an Object</a>
         
        
        <a href="https://leiheng.github.io/posts/linux/linux-sharing/" class="next" rel="next" title="NFS Sharing">NFS Sharing&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2019</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://leiheng.github.io">leiheng</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
